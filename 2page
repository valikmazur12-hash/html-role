{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>–¢–∞–±–ª–∏—Ü—ñ</title>
    <meta charset="UTF-8"> 
    <link rel="stylesheet" href="{% static 'main/data_view.css' %}?v=1.1">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1>–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –†–æ–ª–µ–π –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º</h1>
                <nav class="main-nav">
                    <ul>
                        <li><a href="{% url 'role_assignment' %}">–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è</a></li>
                        <li><a href="{% url 'page_two' %}">–¢–∞–±–ª–∏—Ü—ñ</a></li>
                        <li><a href="{% url 'page_three' %}">–°—Ö–µ–º–∞</a></li>
                        <li><a href="{% url 'page_four' %}" class="active">–ü—Ä–æ—Ñ—ñ–ª—å</a></li> 
                    </ul>
                </nav>
            </div>
        </header>

        <div class="main-form">
            <h2>üìú –¢–∞–±–ª–∏—Ü—è –∑–∞–ø–∏—Å—ñ–≤ (User_list)</h2>

            <form method="GET" action="{% url 'page_two' %}" class="filters-container">
                <div class="filter-group filter-checkboxes">
                    <label>–§—ñ–ª—å—Ç—Ä –ø–æ –î–æ–¥–∞—Ç–∫—É (–ß–µ–∫–±–æ–∫—Å–∏):</label>
                    <div id="app-filter-checkboxes">
                        <div class="checkbox-item">
                            <input type="checkbox" name="app_filter" value="ERP_Finance" {% if 'ERP_Finance' in request.GET.app_filter %}checked{% endif %}>
                            <label>ERP_Finance</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" name="app_filter" value="CRM_Sales" {% if 'CRM_Sales' in request.GET.app_filter %}checked{% endif %}>
                            <label>CRM_Sales</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" name="app_filter" value="HR_Portal" {% if 'HR_Portal' in request.GET.app_filter %}checked{% endif %}>
                            <label>HR_Portal</label>
                        </div>
                    </div>
                </div>
                
                <div class="filter-group filter-text">
                    <label for="role-filter">–§—ñ–ª—å—Ç—Ä –ø–æ –†–æ–ª—ñ:</label>
                    <input type="text" name="role_filter" id="role-filter" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ä–æ–ª—ñ" value="{{ request.GET.role_filter }}">
                </div>

                <button type="submit" class="filter-button">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                <a href="{% url 'page_two' %}" class="filter-button" style="text-decoration: none; background: #6c757d; display: inline-block; text-align: center;">–°–∫–∏–Ω—É—Ç–∏</a>
            </form>
            
            <div class="data-table-container">
                <table class="roles-table">
                    <thead>
                        <tr>
                            <th style="width: 5%;">ID</th>
                            <th style="width: 20%;">–ü–Ü–ë –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</th>
                            <th style="width: 15%;">–ü–æ—Å–∞–¥–∞</th>
                            <th style="width: 30%;">–î–æ–¥–∞—Ç–æ–∫</th>
                            <th style="width: 30%;">–†–æ–ª—ñ</th>
                        </tr>
                    </thead>
                    <tbody id="full-report-tbody">
                        {% for user_data in report_data %}
                        <tr>
                            <td>{{ user_data.id_user }}</td>
                            <td>{{ user_data.pib }}</td>
                            <td>{{ user_data.position }}</td>
                            <td>
                                {% for role in user_data.roles_data %}
                                    {{ role.application }}{% if not forloop.last %}<br>{% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {% for role in user_data.roles_data %}
                                    {{ role.role_name }}{% if not forloop.last %}<br>{% endif %}
                                {% endfor %}
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" style="text-align: center;">–ó–∞ –≤–∫–∞–∑–∞–Ω–∏–º–∏ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏ –¥–∞–Ω–∏—Ö –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>
